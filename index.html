<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <title>Interação com o Contrato PamonhaToken</title>
    <!-- Aqui usamos um link alternativo do Cloudflare CDN para o script ethers.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.6.8/ethers.min.js" integrity="sha512-vOO7W+U0pL9r7hsdTtxp4P7mVXD6S4OgukfzTTNbU0I6dkxy1NgGcRmDjQfesw+mC3V6PsjF7L9DeXRKHZtYEw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
    <button id="connectWalletButton">Conectar Wallet</button>
    <button id="depositButton" disabled>Depositar 0.02 ETH e Receber Pamonha</button>

    <script>
        const contractAddress = '0x1Ef397Cca4296D988EDDD7479479387B340Ff1f1';
        const contractABI = [
            // A ABI que você forneceu
            // ... restante da ABI
        ];

        let provider;
        let signer;
        let contract;

        // Referências para os botões
        const connectWalletButton = document.getElementById('connectWalletButton');
        const depositButton = document.getElementById('depositButton');

        // Conectar à carteira do usuário
        connectWalletButton.addEventListener('click', async () => {
            if (window.ethereum) {
                try {
                    await window.ethereum.request({ method: 'eth_requestAccounts' });
                    provider = new ethers.providers.Web3Provider(window.ethereum);
                    signer = provider.getSigner();
                    contract = new ethers.Contract(contractAddress, contractABI, signer);

                    // Ativar o botão de depósito após a conexão ser estabelecida
                    depositButton.disabled = false;
                } catch (error) {
                    console.error(error);
                }
            } else {
                console.log('Por favor, instale a MetaMask!');
            }
        });

        // Depositar 0.02 ETH e acionar as funções do contrato
        depositButton.addEventListener('click', async () => {
            if (contract) {
                try {
                    const tx = await contract.deposit({
                        value: ethers.utils.parseEther("0.02")
                    });
                    await tx.wait(); // Aguardar a transação ser minerada
                    console.log('Depósito realizado e funções acionadas!');
                } catch (error) {
                    console.error(error);
                }
            } else {
                console.log('Contrato não está conectado');
            }
        });
    </script>
</body>
</html>
